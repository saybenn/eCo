{"ast":null,"code":"import _slicedToArray from\"C:/Users/elijr/Desktop/CODING/Personal Projects/Portfolio/eco/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{LinkContainer}from\"react-router-bootstrap\";import{Col,Row,Form,Button,Card,Table}from\"react-bootstrap\";import Tippy from\"@tippy.js/react\";import\"tippy.js/dist/tippy.css\";import{useNavigate}from\"react-router-dom\";import Container from\"../components/Container\";import Loader from\"../components/Loader\";import Message from\"../components/Message\";import BlogPost from\"../components/BlogPost\";import{updateProfile,getUserProfile,logout}from\"../actions/userActions\";import{listMyOrders}from\"../actions/orderActions\";import{UPDATE_PROFILE_RESET,USER_PROFILE_RESET}from\"../constants/userConstants\";import{listMyBlogs}from\"../actions/blogActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ProfileScreen=function ProfileScreen(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),email=_useState6[0],setEmail=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),confirmPassword=_useState8[0],setConfirmPassword=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),authorRequest=_useState10[0],setAuthorRequest=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),message=_useState12[0],setMessage=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),editState=_useState14[0],setEditState=_useState14[1];var navigate=useNavigate();var dispatch=useDispatch();var userProfile=useSelector(function(state){return state.userProfile;});var loading=userProfile.loading,error=userProfile.error,profile=userProfile.profile;var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var userUpdateProfile=useSelector(function(state){return state.userUpdateProfile;});var success=userUpdateProfile.success;var orderList=useSelector(function(state){return state.orderList;});var orders=orderList.orders,orderLoading=orderList.loading,orderError=orderList.error;var myBlogs=useSelector(function(state){return state.myBlogs;});var blogs=myBlogs.blogs,blogLoading=myBlogs.loading,blogError=myBlogs.error;useEffect(function(){if(!userInfo){dispatch(logout());navigate(\"/login\");}if(!profile||profile.name!==userInfo.name){dispatch(getUserProfile());}if(!orders){dispatch(listMyOrders());}if(!blogs){dispatch(listMyBlogs());}if(profile){setName(profile.name);setEmail(profile.email);setAuthorRequest(profile.authorRequest);}if(success){dispatch({type:USER_PROFILE_RESET});setEditState(false);}},[dispatch,userInfo,success,navigate,profile,orders,blogs]);var toggleAuthor=function toggleAuthor(){if(!authorRequest){setAuthorRequest(true);}else{setAuthorRequest(false);}};var submitHandler=function submitHandler(e){e.preventDefault();if(password!==confirmPassword){setMessage(\"Passwords do not match\");setTimeout(function(){setMessage(false);},3000);}else{dispatch(updateProfile(name,email,password,authorRequest));setPassword(\"\");setConfirmPassword(\"\");}};var toggleEdit=function toggleEdit(){if(!editState){setEditState(true);}if(editState){setEditState(false);}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}),message&&/*#__PURE__*/_jsx(Message,{variant:\"alert\",children:message}),success&&/*#__PURE__*/_jsx(Message,{variant:\"alert\",children:\"Profile Successfully Updated!\"}),profile&&/*#__PURE__*/_jsxs(Col,{md:4,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Profile\"}),/*#__PURE__*/_jsx(Card,{className:\"p-3\",children:/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Name\"})}),/*#__PURE__*/_jsx(Form.Control,{type:\"name\",value:name,placeholder:\"Enter name\",onChange:function onChange(e){return setName(e.target.value);},disabled:!editState?\"disabled\":\"\"})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Email\"})}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",value:email,placeholder:\"Enter email\",onChange:function onChange(e){return setEmail(e.target.value);},disabled:!editState?\"disabled\":\"\"})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Password\"})}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",value:password,placeholder:\"Enter password\",onChange:function onChange(e){return setPassword(e.target.value);},disabled:!editState?\"disabled\":\"\"})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"confirmPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Confirm Password\"})}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",value:confirmPassword,placeholder:\"Enter password\",onChange:function onChange(e){return setConfirmPassword(e.target.value);},disabled:!editState?\"disabled\":\"\"})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{className:\"mt-3 d-flex align-items-center\",md:5,children:[/*#__PURE__*/_jsx(Tippy,{content:\"The Author role allows users to contribute their own blog post to the community. Requests must be approved by an Administrator.\",placement:\"top\",arrow:false,delay:300,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle mx-1\"})}),profile&&profile.isAuthor?/*#__PURE__*/_jsx(Button,{variant:\"success\",disabled:true,children:\"Authorized as Author\"}):profile&&profile.authorRequest?/*#__PURE__*/_jsx(Button,{variant:\"secondary\",disabled:true,children:\"Author Role Requested\"}):/*#__PURE__*/_jsx(Button,{onClick:toggleAuthor,variant:authorRequest?\"success\":\"info\",disabled:!editState,children:\"Request Author Role\"})]}),/*#__PURE__*/_jsxs(Col,{className:\"mt-3\",md:5,children:[!editState&&/*#__PURE__*/_jsx(Button,{onClick:toggleEdit,variant:\"primary\",children:\"Update Profile\"}),editState&&/*#__PURE__*/_jsx(Button,{onClick:(toggleEdit,submitHandler),variant:\"info\",children:\"Submit Update\"})]})]})]})}),\" \"]}),/*#__PURE__*/_jsxs(Col,{md:8,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"My Orders\"}),orders&&orders.length>0?/*#__PURE__*/_jsxs(Table,{bordered:true,hover:true,responsive:true,className:\"table-sm\",variant:\"secondary\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"DATE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"TOTAL\"}),/*#__PURE__*/_jsx(\"th\",{children:\"PAID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"DELIVERED\"}),/*#__PURE__*/_jsx(\"th\",{children:\"ORDER DETAILS\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders&&orders.map(function(order){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order._id}),/*#__PURE__*/_jsx(\"td\",{children:order.createdAt.substring(0,10)}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",order.totalPrice]}),/*#__PURE__*/_jsx(\"td\",{children:order.isPaid?order.paidAt.substring(0,10):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",style:{color:\"red\"}})}),/*#__PURE__*/_jsx(\"td\",{children:order.isDelivered?order.deliveredAt.substring(0,10):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",style:{color:\"red\"}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(LinkContainer,{to:!order.isPaid?\"/order/\".concat(order._id):\"/order/review/\".concat(order._id),children:/*#__PURE__*/_jsx(Button,{className:\"btn-sm\",variant:\"outline-dark\",children:\"Details\"})})})]},order._id);})})]}):/*#__PURE__*/_jsx(Message,{variant:\"info\",children:\"You Have No Orders\"})]})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"My Blog Post\"}),/*#__PURE__*/_jsx(Col,{md:6,children:blogs&&blogs.length>0?blogs.map(function(blog){return/*#__PURE__*/_jsx(Row,{md:8,children:/*#__PURE__*/_jsx(BlogPost,{blog:blog})},blog._id);}):/*#__PURE__*/_jsx(Message,{variant:\"info\",children:\"You Have No Blog Posts\"})})]})]})});};export default ProfileScreen;","map":{"version":3,"sources":["C:/Users/elijr/Desktop/CODING/Personal Projects/Portfolio/eco/frontend/src/screens/ProfileScreen.js"],"names":["React","useState","useEffect","useDispatch","useSelector","LinkContainer","Col","Row","Form","Button","Card","Table","Tippy","useNavigate","Container","Loader","Message","BlogPost","updateProfile","getUserProfile","logout","listMyOrders","UPDATE_PROFILE_RESET","USER_PROFILE_RESET","listMyBlogs","ProfileScreen","name","setName","password","setPassword","email","setEmail","confirmPassword","setConfirmPassword","authorRequest","setAuthorRequest","message","setMessage","editState","setEditState","navigate","dispatch","userProfile","state","loading","error","profile","userLogin","userInfo","userUpdateProfile","success","orderList","orders","orderLoading","orderError","myBlogs","blogs","blogLoading","blogError","type","toggleAuthor","submitHandler","e","preventDefault","setTimeout","toggleEdit","target","value","isAuthor","length","map","order","_id","createdAt","substring","totalPrice","isPaid","paidAt","color","isDelivered","deliveredAt","blog"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { LinkContainer } from \"react-router-bootstrap\";\r\nimport { Col, Row, Form, Button, Card, Table } from \"react-bootstrap\";\r\nimport Tippy from \"@tippy.js/react\";\r\nimport \"tippy.js/dist/tippy.css\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Container from \"../components/Container\";\r\nimport Loader from \"../components/Loader\";\r\nimport Message from \"../components/Message\";\r\nimport BlogPost from \"../components/BlogPost\";\r\nimport { updateProfile, getUserProfile, logout } from \"../actions/userActions\";\r\nimport { listMyOrders } from \"../actions/orderActions\";\r\nimport {\r\n  UPDATE_PROFILE_RESET,\r\n  USER_PROFILE_RESET,\r\n} from \"../constants/userConstants\";\r\nimport { listMyBlogs } from \"../actions/blogActions\";\r\n\r\nconst ProfileScreen = () => {\r\n  const [name, setName] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [authorRequest, setAuthorRequest] = useState(null);\r\n  const [message, setMessage] = useState(null);\r\n  const [editState, setEditState] = useState(null);\r\n\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n\r\n  const userProfile = useSelector((state) => state.userProfile);\r\n  const { loading, error, profile } = userProfile;\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n\r\n  const userUpdateProfile = useSelector((state) => state.userUpdateProfile);\r\n  const { success } = userUpdateProfile;\r\n\r\n  const orderList = useSelector((state) => state.orderList);\r\n  const { orders, loading: orderLoading, error: orderError } = orderList;\r\n\r\n  const myBlogs = useSelector((state) => state.myBlogs);\r\n  const { blogs, loading: blogLoading, error: blogError } = myBlogs;\r\n\r\n  useEffect(() => {\r\n    if (!userInfo) {\r\n      dispatch(logout());\r\n      navigate(\"/login\");\r\n    }\r\n\r\n    if (!profile || profile.name !== userInfo.name) {\r\n      dispatch(getUserProfile());\r\n    }\r\n\r\n    if (!orders) {\r\n      dispatch(listMyOrders());\r\n    }\r\n\r\n    if (!blogs) {\r\n      dispatch(listMyBlogs());\r\n    }\r\n\r\n    if (profile) {\r\n      setName(profile.name);\r\n      setEmail(profile.email);\r\n      setAuthorRequest(profile.authorRequest);\r\n    }\r\n\r\n    if (success) {\r\n      dispatch({ type: USER_PROFILE_RESET });\r\n      setEditState(false);\r\n    }\r\n  }, [dispatch, userInfo, success, navigate, profile, orders, blogs]);\r\n\r\n  const toggleAuthor = () => {\r\n    if (!authorRequest) {\r\n      setAuthorRequest(true);\r\n    } else {\r\n      setAuthorRequest(false);\r\n    }\r\n  };\r\n  const submitHandler = (e) => {\r\n    e.preventDefault();\r\n    if (password !== confirmPassword) {\r\n      setMessage(\"Passwords do not match\");\r\n      setTimeout(() => {\r\n        setMessage(false);\r\n      }, 3000);\r\n    } else {\r\n      dispatch(updateProfile(name, email, password, authorRequest));\r\n      setPassword(\"\");\r\n      setConfirmPassword(\"\");\r\n    }\r\n  };\r\n\r\n  const toggleEdit = () => {\r\n    if (!editState) {\r\n      setEditState(true);\r\n    }\r\n    if (editState) {\r\n      setEditState(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Container>\r\n        <Row className=\"mb-3\">\r\n          {error && <Message variant=\"danger\">{error}</Message>}\r\n          {message && <Message variant=\"alert\">{message}</Message>}\r\n          {success && (\r\n            <Message variant=\"alert\">Profile Successfully Updated!</Message>\r\n          )}\r\n          {profile && (\r\n            <Col md={4}>\r\n              <h2>User Profile</h2>\r\n              <Card className=\"p-3\">\r\n                <Form onSubmit={submitHandler}>\r\n                  <Form.Group controlId=\"name\">\r\n                    <Form.Label>\r\n                      <strong>Name</strong>\r\n                    </Form.Label>\r\n                    <Form.Control\r\n                      type=\"name\"\r\n                      value={name}\r\n                      placeholder=\"Enter name\"\r\n                      onChange={(e) => setName(e.target.value)}\r\n                      disabled={!editState ? \"disabled\" : \"\"}\r\n                    ></Form.Control>\r\n                  </Form.Group>\r\n                  <Form.Group controlId=\"email\">\r\n                    <Form.Label>\r\n                      <strong>Email</strong>\r\n                    </Form.Label>\r\n                    <Form.Control\r\n                      type=\"email\"\r\n                      value={email}\r\n                      placeholder=\"Enter email\"\r\n                      onChange={(e) => setEmail(e.target.value)}\r\n                      disabled={!editState ? \"disabled\" : \"\"}\r\n                    ></Form.Control>\r\n                  </Form.Group>\r\n                  <Form.Group controlId=\"password\">\r\n                    <Form.Label>\r\n                      <strong>Password</strong>\r\n                    </Form.Label>\r\n                    <Form.Control\r\n                      type=\"password\"\r\n                      value={password}\r\n                      placeholder=\"Enter password\"\r\n                      onChange={(e) => setPassword(e.target.value)}\r\n                      disabled={!editState ? \"disabled\" : \"\"}\r\n                    ></Form.Control>\r\n                  </Form.Group>\r\n                  <Form.Group controlId=\"confirmPassword\">\r\n                    <Form.Label>\r\n                      <strong>Confirm Password</strong>\r\n                    </Form.Label>\r\n                    <Form.Control\r\n                      type=\"password\"\r\n                      value={confirmPassword}\r\n                      placeholder=\"Enter password\"\r\n                      onChange={(e) => setConfirmPassword(e.target.value)}\r\n                      disabled={!editState ? \"disabled\" : \"\"}\r\n                    ></Form.Control>\r\n                  </Form.Group>\r\n                  <Row>\r\n                    <Col className=\"mt-3 d-flex align-items-center\" md={5}>\r\n                      <Tippy\r\n                        content=\"The Author role allows users to contribute their own blog post to the community. Requests must be approved by an Administrator.\"\r\n                        placement=\"top\"\r\n                        arrow={false}\r\n                        delay={300}\r\n                      >\r\n                        <i className=\"fas fa-info-circle mx-1\"></i>\r\n                      </Tippy>\r\n                      {profile && profile.isAuthor ? (\r\n                        <Button variant=\"success\" disabled>\r\n                          Authorized as Author\r\n                        </Button>\r\n                      ) : profile && profile.authorRequest ? (\r\n                        <Button variant=\"secondary\" disabled>\r\n                          Author Role Requested\r\n                        </Button>\r\n                      ) : (\r\n                        <Button\r\n                          onClick={toggleAuthor}\r\n                          variant={authorRequest ? \"success\" : \"info\"}\r\n                          disabled={!editState}\r\n                        >\r\n                          Request Author Role\r\n                        </Button>\r\n                      )}\r\n                    </Col>\r\n                    <Col className=\"mt-3\" md={5}>\r\n                      {!editState && (\r\n                        <Button onClick={toggleEdit} variant=\"primary\">\r\n                          Update Profile\r\n                        </Button>\r\n                      )}\r\n                      {editState && (\r\n                        <Button\r\n                          onClick={(toggleEdit, submitHandler)}\r\n                          variant=\"info\"\r\n                        >\r\n                          Submit Update\r\n                        </Button>\r\n                      )}\r\n                    </Col>\r\n                  </Row>\r\n                </Form>\r\n              </Card>{\" \"}\r\n            </Col>\r\n          )}\r\n\r\n          <Col md={8}>\r\n            <h2>My Orders</h2>\r\n            {orders && orders.length > 0 ? (\r\n              <Table\r\n                bordered\r\n                hover\r\n                responsive\r\n                className=\"table-sm\"\r\n                variant=\"secondary\"\r\n              >\r\n                <thead>\r\n                  <tr>\r\n                    <th>ID</th>\r\n                    <th>DATE</th>\r\n                    <th>TOTAL</th>\r\n                    <th>PAID</th>\r\n                    <th>DELIVERED</th>\r\n                    <th>ORDER DETAILS</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {orders &&\r\n                    orders.map((order) => (\r\n                      <tr key={order._id}>\r\n                        <td>{order._id}</td>\r\n                        <td>{order.createdAt.substring(0, 10)}</td>\r\n                        <td>${order.totalPrice}</td>\r\n                        <td>\r\n                          {order.isPaid ? (\r\n                            order.paidAt.substring(0, 10)\r\n                          ) : (\r\n                            <i\r\n                              className=\"fas fa-times\"\r\n                              style={{ color: \"red\" }}\r\n                            ></i>\r\n                          )}\r\n                        </td>\r\n                        <td>\r\n                          {order.isDelivered ? (\r\n                            order.deliveredAt.substring(0, 10)\r\n                          ) : (\r\n                            <i\r\n                              className=\"fas fa-times\"\r\n                              style={{ color: \"red\" }}\r\n                            ></i>\r\n                          )}\r\n                        </td>\r\n                        <td>\r\n                          <LinkContainer\r\n                            to={\r\n                              !order.isPaid\r\n                                ? `/order/${order._id}`\r\n                                : `/order/review/${order._id}`\r\n                            }\r\n                          >\r\n                            <Button className=\"btn-sm\" variant=\"outline-dark\">\r\n                              Details\r\n                            </Button>\r\n                          </LinkContainer>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                </tbody>\r\n              </Table>\r\n            ) : (\r\n              <Message variant=\"info\">You Have No Orders</Message>\r\n            )}\r\n          </Col>\r\n        </Row>\r\n        <Row>\r\n          <h2>My Blog Post</h2>\r\n\r\n          <Col md={6}>\r\n            {blogs && blogs.length > 0 ? (\r\n              blogs.map((blog) => (\r\n                <Row key={blog._id} md={8}>\r\n                  <BlogPost blog={blog} />\r\n                </Row>\r\n              ))\r\n            ) : (\r\n              <Message variant=\"info\">You Have No Blog Posts</Message>\r\n            )}\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProfileScreen;\r\n"]},"metadata":{},"sourceType":"module"}