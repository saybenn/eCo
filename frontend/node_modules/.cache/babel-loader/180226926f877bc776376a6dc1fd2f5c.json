{"ast":null,"code":"import _toConsumableArray from\"C:/Users/elijr/Desktop/CODING/Personal Projects/Portfolio/eco/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/elijr/Desktop/CODING/Personal Projects/Portfolio/eco/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Link,useParams}from\"react-router-dom\";import{useSelector,useDispatch}from\"react-redux\";import{Image,Row,Col,Card,ListGroup,Form,Button,ListGroupItem}from\"react-bootstrap\";import Container from\"../components/Container\";import Rating from\"../components/Rating\";import Loader from\"../components/Loader\";import Message from\"../components/Message\";import{createReview,getProductDetails}from\"../actions/productActions\";import{addItemToCart}from\"../actions/cartActions\";import{ADD_CART_RESET}from\"../constants/cartConstants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ProductScreen=function ProductScreen(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),rating=_useState4[0],setRating=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),options=_useState6[0],setOptions=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),qty=_useState8[0],setQty=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),message=_useState10[0],setMessage=_useState10[1];var _useParams=useParams(),id=_useParams.id;var dispatch=useDispatch();var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var productReview=useSelector(function(state){return state.productReview;});var errorReview=productReview.error,reviewSuccess=productReview.success;var productDetails=useSelector(function(state){return state.productDetails;});var loading=productDetails.loading,error=productDetails.error,product=productDetails.product;var cartAdd=useSelector(function(state){return state.cartAdd;});var cartError=cartAdd.error,success=cartAdd.success;useEffect(function(){dispatch(getProductDetails(id));if(reviewSuccess){dispatch(getProductDetails(id));}if(cartError){setMessage(\"There was a problem adding \".concat(product.name,\" to your cart. Try again or check if you are logged in.\"));setTimeout(function(){setMessage(false);dispatch({type:ADD_CART_RESET});},3000);}},[dispatch,cartError,reviewSuccess,product.name,id]);var addToCartHandler=function addToCartHandler(){if(product.optionName&&!options){setMessage(\"Please select \".concat(product.optionName));setTimeout(function(){setMessage(false);},5000);}else{dispatch(addItemToCart(product.name,product.price,product.image,product._id,qty,options,product.optionName));setMessage(\"\".concat(product.name,\" has been added to your cart.\"));setTimeout(function(){setMessage(false);},3500);}};var submitHandler=function submitHandler(e){e.preventDefault();dispatch(createReview(id,rating,comment));setComment(\"\");setRating(0);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Link,{to:\"/shop\",type:\"button\",className:\"btn btn-dark my-3\",children:\"Back\"}),message&&/*#__PURE__*/_jsx(Message,{variant:\"info\",children:message}),loading&&/*#__PURE__*/_jsx(Loader,{}),error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}),product&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Row,{className:\"d-flex \",children:[/*#__PURE__*/_jsxs(Col,{md:5,children:[/*#__PURE__*/_jsx(Image,{src:product.image,alt:product.name,className:\"mb-3\",fluid:true}),/*#__PURE__*/_jsx(Rating,{value:product.rating,text:\"\".concat(product.numReviews,\" reviews\")}),\" \"]}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:/*#__PURE__*/_jsxs(\"h2\",{children:[\" \",product.name]})}),/*#__PURE__*/_jsx(Card.Subtitle,{className:\"mb-2\",children:/*#__PURE__*/_jsxs(\"h4\",{children:[\"$\",product.price]})}),/*#__PURE__*/_jsx(Card.Text,{children:product.description})]}),/*#__PURE__*/_jsxs(ListGroupItem,{children:[/*#__PURE__*/_jsxs(Row,{className:\"mt-2 align-items-center\",children:[/*#__PURE__*/_jsxs(Col,{md:5,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",product.countInStock>0?\"In Stock\":\"Out of Stock\"]}),product.optionName&&/*#__PURE__*/_jsxs(Col,{md:7,className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"mx-1\",children:\"\".concat(product.optionName,\": \")}),/*#__PURE__*/_jsxs(Form.Control,{className:\"m-0\",value:options,as:\"select\",onChange:function onChange(e){return setOptions(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"caution\",children:\"Select a Value\"}),product.options.map(function(o){return/*#__PURE__*/_jsx(\"option\",{value:o,children:o},o++);})]})]})]}),/*#__PURE__*/_jsxs(Row,{className:\"my-3 align-items-center\",children:[/*#__PURE__*/_jsxs(Col,{className:\"d-flex align-items-center\",md:5,children:[/*#__PURE__*/_jsx(\"strong\",{className:\"mx-1\",children:\"Qty:\"}),\" \",/*#__PURE__*/_jsx(Form.Control,{className:\"m-0\",as:\"select\",value:qty,onChange:function onChange(e){return setQty(e.target.value);},children:_toConsumableArray(Array(product.countInStock).keys()).map(function(x){return/*#__PURE__*/_jsx(\"option\",{value:x+1,children:x+1},x+1);})})]}),/*#__PURE__*/_jsx(Col,{md:7,children:/*#__PURE__*/_jsx(Button,{className:\"btn btn-dark w-100\",onClick:addToCartHandler,disabled:product.countInStock===0,children:\"Add To Cart\"})})]})]})]})})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{md:7,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"my-3\",children:\"Reviews\"}),product.reviews.length===0?/*#__PURE__*/_jsx(Message,{variant:\"info\",children:\"No Reviews\"}):product.reviews.map(function(review){return/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsxs(Row,{className:\"justify-space-between\",children:[/*#__PURE__*/_jsx(\"strong\",{children:review.name}),/*#__PURE__*/_jsx(Rating,{value:review.rating})]}),/*#__PURE__*/_jsx(\"p\",{children:review.createdAt.substring(0,10)}),/*#__PURE__*/_jsx(\"p\",{children:review.comment})]},review._id);}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Write a Customer Review\"}),errorReview&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorReview}),userInfo?/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"rating\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Rating\"}),/*#__PURE__*/_jsxs(Form.Control,{as:\"select\",value:rating,onChange:function onChange(e){return setRating(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"1 - Poor\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"2 - Fair\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"3 - Good\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"4 - Very Good\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"5 - Excellent\"})]})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"comment\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Comment\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",row:\"3\",value:comment,onChange:function onChange(e){return setComment(e.target.value);}})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"secondary\",children:\"Submit Review\"})]}):/*#__PURE__*/_jsxs(Message,{children:[\"Please \",/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"sign in\"}),\" to write a review\"]})]})]})})]})]})});};export default ProductScreen;","map":{"version":3,"sources":["C:/Users/elijr/Desktop/CODING/Personal Projects/Portfolio/eco/frontend/src/screens/ProductScreen.js"],"names":["React","useState","useEffect","Link","useParams","useSelector","useDispatch","Image","Row","Col","Card","ListGroup","Form","Button","ListGroupItem","Container","Rating","Loader","Message","createReview","getProductDetails","addItemToCart","ADD_CART_RESET","ProductScreen","comment","setComment","rating","setRating","options","setOptions","qty","setQty","message","setMessage","id","dispatch","userLogin","state","userInfo","productReview","errorReview","error","reviewSuccess","success","productDetails","loading","product","cartAdd","cartError","name","setTimeout","type","addToCartHandler","optionName","price","image","_id","submitHandler","e","preventDefault","numReviews","description","countInStock","target","value","map","o","Array","keys","x","reviews","length","review","createdAt","substring"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Link, useParams } from \"react-router-dom\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport {\r\n  Image,\r\n  Row,\r\n  Col,\r\n  Card,\r\n  ListGroup,\r\n  Form,\r\n  Button,\r\n  ListGroupItem,\r\n} from \"react-bootstrap\";\r\nimport Container from \"../components/Container\";\r\nimport Rating from \"../components/Rating\";\r\nimport Loader from \"../components/Loader\";\r\nimport Message from \"../components/Message\";\r\nimport { createReview, getProductDetails } from \"../actions/productActions\";\r\nimport { addItemToCart } from \"../actions/cartActions\";\r\nimport { ADD_CART_RESET } from \"../constants/cartConstants\";\r\nconst ProductScreen = () => {\r\n  const [comment, setComment] = useState(\"\");\r\n  const [rating, setRating] = useState(0);\r\n  const [options, setOptions] = useState(\"\");\r\n  const [qty, setQty] = useState(1);\r\n  const [message, setMessage] = useState(\"\");\r\n  const { id } = useParams();\r\n  const dispatch = useDispatch();\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n  const productReview = useSelector((state) => state.productReview);\r\n  const { error: errorReview, success: reviewSuccess } = productReview;\r\n  const productDetails = useSelector((state) => state.productDetails);\r\n  const { loading, error, product } = productDetails;\r\n  const cartAdd = useSelector((state) => state.cartAdd);\r\n  const { error: cartError, success } = cartAdd;\r\n\r\n  useEffect(() => {\r\n    dispatch(getProductDetails(id));\r\n    if (reviewSuccess) {\r\n      dispatch(getProductDetails(id));\r\n    }\r\n    if (cartError) {\r\n      setMessage(\r\n        `There was a problem adding ${product.name} to your cart. Try again or check if you are logged in.`\r\n      );\r\n      setTimeout(() => {\r\n        setMessage(false);\r\n        dispatch({ type: ADD_CART_RESET });\r\n      }, 3000);\r\n    }\r\n  }, [dispatch, cartError, reviewSuccess, product.name, id]);\r\n\r\n  const addToCartHandler = () => {\r\n    if (product.optionName && !options) {\r\n      setMessage(`Please select ${product.optionName}`);\r\n      setTimeout(() => {\r\n        setMessage(false);\r\n      }, 5000);\r\n    } else {\r\n      dispatch(\r\n        addItemToCart(\r\n          product.name,\r\n          product.price,\r\n          product.image,\r\n          product._id,\r\n          qty,\r\n          options,\r\n          product.optionName\r\n        )\r\n      );\r\n      setMessage(`${product.name} has been added to your cart.`);\r\n      setTimeout(() => {\r\n        setMessage(false);\r\n      }, 3500);\r\n    }\r\n  };\r\n\r\n  const submitHandler = (e) => {\r\n    e.preventDefault();\r\n    dispatch(createReview(id, rating, comment));\r\n    setComment(\"\");\r\n    setRating(0);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Container>\r\n        <Link to=\"/shop\" type=\"button\" className=\"btn btn-dark my-3\">\r\n          Back\r\n        </Link>\r\n        {message && <Message variant=\"info\">{message}</Message>}\r\n        {loading && <Loader />}\r\n        {error && <Message variant=\"danger\">{error}</Message>}\r\n        {product && (\r\n          <>\r\n            <Row className=\"d-flex \">\r\n              <Col md={5}>\r\n                <Image\r\n                  src={product.image}\r\n                  alt={product.name}\r\n                  className=\"mb-3\"\r\n                  fluid\r\n                />\r\n                <Rating\r\n                  value={product.rating}\r\n                  text={`${product.numReviews} reviews`}\r\n                />{\" \"}\r\n              </Col>\r\n\r\n              <Col md={4}>\r\n                <Card>\r\n                  <Card.Body>\r\n                    <Card.Title>\r\n                      <h2> {product.name}</h2>\r\n                    </Card.Title>\r\n                    <Card.Subtitle className=\"mb-2\">\r\n                      <h4>${product.price}</h4>\r\n                    </Card.Subtitle>\r\n                    <Card.Text>{product.description}</Card.Text>\r\n                  </Card.Body>\r\n                  <ListGroupItem>\r\n                    <Row className=\"mt-2 align-items-center\">\r\n                      <Col md={5}>\r\n                        <strong>Status:</strong>{\" \"}\r\n                        {product.countInStock > 0 ? \"In Stock\" : \"Out of Stock\"}\r\n                      </Col>\r\n                      {product.optionName && (\r\n                        <Col md={7} className=\"d-flex align-items-center\">\r\n                          <strong className=\"mx-1\">{`${product.optionName}: `}</strong>\r\n\r\n                          <Form.Control\r\n                            className=\"m-0\"\r\n                            value={options}\r\n                            as=\"select\"\r\n                            onChange={(e) => setOptions(e.target.value)}\r\n                          >\r\n                            <option value=\"caution\">Select a Value</option>\r\n                            {product.options.map((o) => (\r\n                              <option key={o++} value={o}>\r\n                                {o}\r\n                              </option>\r\n                            ))}\r\n                          </Form.Control>\r\n                        </Col>\r\n                      )}\r\n                    </Row>\r\n                    <Row className=\"my-3 align-items-center\">\r\n                      <Col className=\"d-flex align-items-center\" md={5}>\r\n                        <strong className=\"mx-1\">Qty:</strong>{\" \"}\r\n                        <Form.Control\r\n                          className=\"m-0\"\r\n                          as=\"select\"\r\n                          value={qty}\r\n                          onChange={(e) => setQty(e.target.value)}\r\n                        >\r\n                          {[...Array(product.countInStock).keys()].map((x) => (\r\n                            <option key={x + 1} value={x + 1}>\r\n                              {x + 1}\r\n                            </option>\r\n                          ))}\r\n                        </Form.Control>\r\n                      </Col>\r\n                      <Col md={7}>\r\n                        <Button\r\n                          className=\"btn btn-dark w-100\"\r\n                          onClick={addToCartHandler}\r\n                          disabled={product.countInStock === 0}\r\n                        >\r\n                          Add To Cart\r\n                        </Button>\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroupItem>\r\n                </Card>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col md={7}>\r\n                <h2 className=\"my-3\">Reviews</h2>\r\n                {product.reviews.length === 0 ? (\r\n                  <Message variant=\"info\">No Reviews</Message>\r\n                ) : (\r\n                  product.reviews.map((review) => (\r\n                    <ListGroup.Item key={review._id}>\r\n                      <Row className=\"justify-space-between\">\r\n                        <strong>{review.name}</strong>\r\n                        <Rating value={review.rating} />\r\n                      </Row>\r\n                      <p>{review.createdAt.substring(0, 10)}</p>\r\n                      <p>{review.comment}</p>\r\n                    </ListGroup.Item>\r\n                  ))\r\n                )}\r\n                <ListGroup.Item>\r\n                  <h2>Write a Customer Review</h2>\r\n                  {errorReview && (\r\n                    <Message variant=\"danger\">{errorReview}</Message>\r\n                  )}\r\n                  {userInfo ? (\r\n                    <Form onSubmit={submitHandler}>\r\n                      <Form.Group controlId=\"rating\">\r\n                        <Form.Label>Rating</Form.Label>\r\n                        <Form.Control\r\n                          as=\"select\"\r\n                          value={rating}\r\n                          onChange={(e) => setRating(e.target.value)}\r\n                        >\r\n                          <option value=\"\">Select...</option>\r\n                          <option value=\"1\">1 - Poor</option>\r\n                          <option value=\"2\">2 - Fair</option>\r\n                          <option value=\"3\">3 - Good</option>\r\n                          <option value=\"4\">4 - Very Good</option>\r\n                          <option value=\"5\">5 - Excellent</option>\r\n                        </Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"comment\">\r\n                        <Form.Label>Comment</Form.Label>\r\n                        <Form.Control\r\n                          as=\"textarea\"\r\n                          row=\"3\"\r\n                          value={comment}\r\n                          onChange={(e) => setComment(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Button type=\"submit\" variant=\"secondary\">\r\n                        Submit Review\r\n                      </Button>\r\n                    </Form>\r\n                  ) : (\r\n                    <Message>\r\n                      Please <Link to=\"/login\">sign in</Link> to write a review\r\n                    </Message>\r\n                  )}\r\n                </ListGroup.Item>\r\n              </Col>\r\n            </Row>\r\n          </>\r\n        )}\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProductScreen;\r\n"]},"metadata":{},"sourceType":"module"}