{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\elijr\\\\Desktop\\\\CODING\\\\Personal Projects\\\\Portfolio\\\\eco\\\\frontend\\\\src\\\\screens\\\\OrderPayScreen.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport CheckoutForm from \"../components/CheckoutForm\";\nimport { Button, Form, Row, Col, ListGroup, Image, Card } from \"react-bootstrap\";\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Container from \"../components/Container\";\nimport Message from \"../components/Message\";\nimport CheckoutSteps from \"../components/CheckoutSteps\";\nimport { getOrder, payOrder } from \"../actions/orderActions\";\nimport { logout } from \"../actions/userActions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_51KfRvoCiXm4UN3ie2rCe8bQxPrNDY3Fck0a33xKG8NlkqieYNBmUcd26Wu1DdKA9lrGZrDLBIPx7UhxBvVErUaEs00F5dPdgJD\");\n\nconst PlaceOrderScreen = () => {\n  _s();\n\n  const [paymentMethod, setPaymentMethod] = useState(\"\");\n  const [clientSecret, setClientSecret] = useState(\"\");\n  const [sdkReady, setSdkReady] = useState(false);\n  const {\n    id\n  } = useParams();\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    userInfo\n  } = userLogin;\n  const orderDetails = useSelector(state => state.orderDetails);\n  const {\n    order,\n    shippingAddress,\n    error\n  } = orderDetails;\n  useEffect(() => {\n    if (!userInfo) {\n      dispatch(logout());\n      navigate(\"/login\");\n    }\n\n    dispatch(getOrder(id));\n\n    async function stripeHandler() {\n      const name = order.customer.name;\n      const email = order.customer.email;\n      const {\n        data\n      } = await axios.post(\"/create-payment-intent\", {\n        id,\n        name,\n        email\n      });\n      setClientSecret(data.clientSecret);\n    }\n\n    const addPayPalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get(\"/api/config/paypal\");\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        setSdkReady(true);\n      };\n\n      document.body.appendChild(script);\n      setSdkReady(true);\n    };\n\n    if (paymentMethod === \"PayPal\") {\n      addPayPalScript();\n    } else {\n      setSdkReady(true);\n    }\n\n    if (paymentMethod === \"Stripe\") {\n      stripeHandler();\n    }\n  }, [dispatch, id, userInfo, paymentMethod, sdkReady]);\n  const appearance = {\n    theme: \"stripe\"\n  };\n  const options = {\n    clientSecret,\n    appearance\n  };\n\n  const successPaymentHandler = () => {\n    dispatch(payOrder(id));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: order && /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(CheckoutSteps, {\n        step1: true,\n        step2: true,\n        step3: true,\n        id: id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Order Items\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            className: \"p-3\",\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: order.orderItems.map(item => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  className: \"d-flex justify-content-between align-items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    md: 2,\n                    children: /*#__PURE__*/_jsxDEV(Image, {\n                      src: item.image,\n                      alt: item.name,\n                      fluid: true,\n                      rounded: true,\n                      sm: 1\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 109,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 108,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 2,\n                    children: /*#__PURE__*/_jsxDEV(Link, {\n                      to: `/product/${item.productId}`,\n                      children: item.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 118,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 117,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 2,\n                    children: [\"$\", item.price]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 122,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 1,\n                    children: item.qty\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 123,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    className: \"d-flex justify-content-center\",\n                    md: 2,\n                    children: item.totalPrice ? `$${item.totalPrice.toFixed(2)}` : `$${item.price.toFixed(2)}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 125,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 107,\n                  columnNumber: 23\n                }, this)\n              }, item._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Order Summary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            className: \"p-3\",\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Items\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.itemsPrice.toFixed(2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 143,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Shipping\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 148,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.shippingPrice.toFixed(2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 149,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 147,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Tax\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 154,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.taxPrice.toFixed(2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 155,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.totalPrice.toFixed(2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 161,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        className: \"my-5\",\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Shipping Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            className: \"p-3\",\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Name:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 21\n                }, this), \" \", order.user.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"email:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 177,\n                  columnNumber: 21\n                }, this), \" \", order.user.email]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Shipping Address:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 21\n                }, this), ` ${order.shippingAddress.address}, ${order.shippingAddress.city} ${order.shippingAddress.state} ${order.shippingAddress.postalCode}, ${order.shippingAddress.country}`]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Payment Method\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            className: \"p-3\",\n            children: !paymentMethod ? /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Check, {\n                type: \"radio\",\n                label: \"Paypal\",\n                id: \"PayPal\",\n                name: \"paymentMethod\",\n                value: \"PayPal\",\n                onChange: e => setPaymentMethod(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                type: \"radio\",\n                label: \"Stripe/Credit Card\",\n                id: \"Stripe\",\n                name: \"paymentMethod\",\n                value: \"Stripe\",\n                onChange: e => setPaymentMethod(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                type: \"submit\",\n                variant: \"primary\",\n                children: \"Continue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 19\n            }, this) : sdkReady ? /*#__PURE__*/_jsxDEV(PayPalButton, {\n              amount: order.totalPrice,\n              onSuccess: successPaymentHandler\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(Elements, {\n              options: options,\n              stripe: stripePromise,\n              children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n                clientSecret: clientSecret,\n                id: id\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n\n_s(PlaceOrderScreen, \"/2jvJ6GkDB0mwf6AEFL4ZHTWtn4=\", false, function () {\n  return [useParams, useDispatch, useNavigate, useSelector, useSelector];\n});\n\n_c = PlaceOrderScreen;\nexport default PlaceOrderScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlaceOrderScreen\");","map":{"version":3,"sources":["C:/Users/elijr/Desktop/CODING/Personal Projects/Portfolio/eco/frontend/src/screens/OrderPayScreen.js"],"names":["React","useState","useEffect","axios","PayPalButton","loadStripe","Elements","CheckoutForm","Button","Form","Row","Col","ListGroup","Image","Card","Link","useNavigate","useParams","useDispatch","useSelector","Container","Message","CheckoutSteps","getOrder","payOrder","logout","stripePromise","PlaceOrderScreen","paymentMethod","setPaymentMethod","clientSecret","setClientSecret","sdkReady","setSdkReady","id","dispatch","navigate","userLogin","state","userInfo","orderDetails","order","shippingAddress","error","stripeHandler","name","customer","email","data","post","addPayPalScript","clientId","get","script","document","createElement","type","src","async","onload","body","appendChild","appearance","theme","options","successPaymentHandler","orderItems","map","item","image","productId","price","qty","totalPrice","toFixed","_id","itemsPrice","shippingPrice","taxPrice","user","address","city","postalCode","country","e","target","value"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,wBAA7B;AACA,SAASC,UAAT,QAA2B,mBAA3B;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,OAAOC,YAAP,MAAyB,4BAAzB;AACA,SACEC,MADF,EAEEC,IAFF,EAGEC,GAHF,EAIEC,GAJF,EAKEC,SALF,EAMEC,KANF,EAOEC,IAPF,QAQO,iBARP;AASA,SAASC,IAAT,EAAeC,WAAf,EAA4BC,SAA5B,QAA6C,kBAA7C;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,aAAP,MAA0B,6BAA1B;AACA,SAASC,QAAT,EAAmBC,QAAnB,QAAmC,yBAAnC;AACA,SAASC,MAAT,QAAuB,wBAAvB;;;AAEA,MAAMC,aAAa,GAAGrB,UAAU,CAC9B,6GAD8B,CAAhC;;AAGA,MAAMsB,gBAAgB,GAAG,MAAM;AAAA;;AAC7B,QAAM,CAACC,aAAD,EAAgBC,gBAAhB,IAAoC5B,QAAQ,CAAC,EAAD,CAAlD;AACA,QAAM,CAAC6B,YAAD,EAAeC,eAAf,IAAkC9B,QAAQ,CAAC,EAAD,CAAhD;AACA,QAAM,CAAC+B,QAAD,EAAWC,WAAX,IAA0BhC,QAAQ,CAAC,KAAD,CAAxC;AAEA,QAAM;AAAEiC,IAAAA;AAAF,MAASjB,SAAS,EAAxB;AACA,QAAMkB,QAAQ,GAAGjB,WAAW,EAA5B;AACA,QAAMkB,QAAQ,GAAGpB,WAAW,EAA5B;AAEA,QAAMqB,SAAS,GAAGlB,WAAW,CAAEmB,KAAD,IAAWA,KAAK,CAACD,SAAlB,CAA7B;AACA,QAAM;AAAEE,IAAAA;AAAF,MAAeF,SAArB;AAEA,QAAMG,YAAY,GAAGrB,WAAW,CAAEmB,KAAD,IAAWA,KAAK,CAACE,YAAlB,CAAhC;AACA,QAAM;AAAEC,IAAAA,KAAF;AAASC,IAAAA,eAAT;AAA0BC,IAAAA;AAA1B,MAAoCH,YAA1C;AAEAtC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACqC,QAAL,EAAe;AACbJ,MAAAA,QAAQ,CAACV,MAAM,EAAP,CAAR;AACAW,MAAAA,QAAQ,CAAC,QAAD,CAAR;AACD;;AACDD,IAAAA,QAAQ,CAACZ,QAAQ,CAACW,EAAD,CAAT,CAAR;;AAEA,mBAAeU,aAAf,GAA+B;AAC7B,YAAMC,IAAI,GAAGJ,KAAK,CAACK,QAAN,CAAeD,IAA5B;AACA,YAAME,KAAK,GAAGN,KAAK,CAACK,QAAN,CAAeC,KAA7B;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAW,MAAM7C,KAAK,CAAC8C,IAAN,CAAW,wBAAX,EAAqC;AAC1Df,QAAAA,EAD0D;AAE1DW,QAAAA,IAF0D;AAG1DE,QAAAA;AAH0D,OAArC,CAAvB;AAKAhB,MAAAA,eAAe,CAACiB,IAAI,CAAClB,YAAN,CAAf;AACD;;AAED,UAAMoB,eAAe,GAAG,YAAY;AAClC,YAAM;AAAEF,QAAAA,IAAI,EAAEG;AAAR,UAAqB,MAAMhD,KAAK,CAACiD,GAAN,CAAU,oBAAV,CAAjC;AACA,YAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,MAAAA,MAAM,CAACG,IAAP,GAAc,iBAAd;AACAH,MAAAA,MAAM,CAACI,GAAP,GAAc,2CAA0CN,QAAS,EAAjE;AACAE,MAAAA,MAAM,CAACK,KAAP,GAAe,IAAf;;AACAL,MAAAA,MAAM,CAACM,MAAP,GAAgB,MAAM;AACpB1B,QAAAA,WAAW,CAAC,IAAD,CAAX;AACD,OAFD;;AAGAqB,MAAAA,QAAQ,CAACM,IAAT,CAAcC,WAAd,CAA0BR,MAA1B;AACApB,MAAAA,WAAW,CAAC,IAAD,CAAX;AACD,KAXD;;AAYA,QAAIL,aAAa,KAAK,QAAtB,EAAgC;AAC9BsB,MAAAA,eAAe;AAChB,KAFD,MAEO;AACLjB,MAAAA,WAAW,CAAC,IAAD,CAAX;AACD;;AAED,QAAIL,aAAa,KAAK,QAAtB,EAAgC;AAC9BgB,MAAAA,aAAa;AACd;AACF,GAvCQ,EAuCN,CAACT,QAAD,EAAWD,EAAX,EAAeK,QAAf,EAAyBX,aAAzB,EAAwCI,QAAxC,CAvCM,CAAT;AAyCA,QAAM8B,UAAU,GAAG;AACjBC,IAAAA,KAAK,EAAE;AADU,GAAnB;AAGA,QAAMC,OAAO,GAAG;AACdlC,IAAAA,YADc;AAEdgC,IAAAA;AAFc,GAAhB;;AAKA,QAAMG,qBAAqB,GAAG,MAAM;AAClC9B,IAAAA,QAAQ,CAACX,QAAQ,CAACU,EAAD,CAAT,CAAR;AACD,GAFD;;AAIA,sBACE;AAAA,cACGO,KAAK,iBACJ,QAAC,SAAD;AAAA,8BACE,QAAC,aAAD;AAAe,QAAA,KAAK,MAApB;AAAqB,QAAA,KAAK,MAA1B;AAA2B,QAAA,KAAK,MAAhC;AAAiC,QAAA,EAAE,EAAEP;AAArC;AAAA;AAAA;AAAA;AAAA,cADF,eAEE,QAAC,GAAD;AAAA,gCACE,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE,QAAC,IAAD;AAAM,YAAA,SAAS,EAAC,KAAhB;AAAA,mCACE,QAAC,SAAD;AAAW,cAAA,OAAO,EAAC,OAAnB;AAAA,wBACGO,KAAK,CAACyB,UAAN,CAAiBC,GAAjB,CAAsBC,IAAD,iBACpB,QAAC,SAAD,CAAW,IAAX;AAAA,uCACE,QAAC,GAAD;AAAK,kBAAA,SAAS,EAAC,mDAAf;AAAA,0CACE,QAAC,GAAD;AAAK,oBAAA,EAAE,EAAE,CAAT;AAAA,2CACE,QAAC,KAAD;AACE,sBAAA,GAAG,EAAEA,IAAI,CAACC,KADZ;AAEE,sBAAA,GAAG,EAAED,IAAI,CAACvB,IAFZ;AAGE,sBAAA,KAAK,MAHP;AAIE,sBAAA,OAAO,MAJT;AAKE,sBAAA,EAAE,EAAE;AALN;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BADF,eAUE,QAAC,GAAD;AAAK,oBAAA,EAAE,EAAE,CAAT;AAAA,2CACE,QAAC,IAAD;AAAM,sBAAA,EAAE,EAAG,YAAWuB,IAAI,CAACE,SAAU,EAArC;AAAA,gCACGF,IAAI,CAACvB;AADR;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BAVF,eAeE,QAAC,GAAD;AAAK,oBAAA,EAAE,EAAE,CAAT;AAAA,oCAAcuB,IAAI,CAACG,KAAnB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAfF,eAgBE,QAAC,GAAD;AAAK,oBAAA,EAAE,EAAE,CAAT;AAAA,8BAAaH,IAAI,CAACI;AAAlB;AAAA;AAAA;AAAA;AAAA,0BAhBF,eAkBE,QAAC,GAAD;AAAK,oBAAA,SAAS,EAAC,+BAAf;AAA+C,oBAAA,EAAE,EAAE,CAAnD;AAAA,8BACGJ,IAAI,CAACK,UAAL,GACI,IAAGL,IAAI,CAACK,UAAL,CAAgBC,OAAhB,CAAwB,CAAxB,CAA2B,EADlC,GAEI,IAAGN,IAAI,CAACG,KAAL,CAAWG,OAAX,CAAmB,CAAnB,CAAsB;AAHhC;AAAA;AAAA;AAAA;AAAA,0BAlBF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF,iBAAqBN,IAAI,CAACO,GAA1B;AAAA;AAAA;AAAA;AAAA,sBADD;AADH;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAoCE,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE,QAAC,IAAD;AAAM,YAAA,SAAS,EAAC,KAAhB;AAAA,mCACE,QAAC,SAAD;AAAW,cAAA,OAAO,EAAC,OAAnB;AAAA,sCACE,QAAC,SAAD,CAAW,IAAX;AAAA,uCACE,QAAC,GAAD;AAAA,0CACE,QAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAEE,QAAC,GAAD;AAAA,oCAAOlC,KAAK,CAACmC,UAAN,CAAiBF,OAAjB,CAAyB,CAAzB,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA,0BAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,sBADF,eAOE,QAAC,SAAD,CAAW,IAAX;AAAA,uCACE,QAAC,GAAD;AAAA,0CACE,QAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAEE,QAAC,GAAD;AAAA,oCAAOjC,KAAK,CAACoC,aAAN,CAAoBH,OAApB,CAA4B,CAA5B,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA,0BAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,sBAPF,eAaE,QAAC,SAAD,CAAW,IAAX;AAAA,uCACE,QAAC,GAAD;AAAA,0CACE,QAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAEE,QAAC,GAAD;AAAA,oCAAOjC,KAAK,CAACqC,QAAN,CAAeJ,OAAf,CAAuB,CAAvB,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA,0BAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,sBAbF,eAmBE,QAAC,SAAD,CAAW,IAAX;AAAA,uCACE,QAAC,GAAD;AAAA,0CACE,QAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAEE,QAAC,GAAD;AAAA,oCAAOjC,KAAK,CAACgC,UAAN,CAAiBC,OAAjB,CAAyB,CAAzB,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA,0BAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,sBAnBF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBApCF;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF,eAsEE,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA,gCACE,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE,QAAC,IAAD;AAAM,YAAA,SAAS,EAAC,KAAhB;AAAA,mCACE,QAAC,SAAD;AAAW,cAAA,OAAO,EAAC,OAAnB;AAAA,sCACE,QAAC,SAAD,CAAW,IAAX;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,OAC0BjC,KAAK,CAACsC,IAAN,CAAWlC,IADrC;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAIE,QAAC,SAAD,CAAW,IAAX;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,OAC2BJ,KAAK,CAACsC,IAAN,CAAWhC,KADtC;AAAA;AAAA;AAAA;AAAA;AAAA,sBAJF,eAOE,QAAC,SAAD,CAAW,IAAX;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,EAEI,IAAGN,KAAK,CAACC,eAAN,CAAsBsC,OAAQ,KAAIvC,KAAK,CAACC,eAAN,CAAsBuC,IAAK,IAAGxC,KAAK,CAACC,eAAN,CAAsBJ,KAAM,IAAGG,KAAK,CAACC,eAAN,CAAsBwC,UAAW,KAAIzC,KAAK,CAACC,eAAN,CAAsByC,OAAQ,EAFzK;AAAA;AAAA;AAAA;AAAA;AAAA,sBAPF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAkBE,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE,QAAC,IAAD;AAAM,YAAA,SAAS,EAAC,KAAhB;AAAA,sBACG,CAACvD,aAAD,gBACC,QAAC,SAAD;AAAW,cAAA,OAAO,EAAC,OAAnB;AAAA,sCACE,QAAC,IAAD,CAAM,KAAN;AACE,gBAAA,IAAI,EAAC,OADP;AAEE,gBAAA,KAAK,EAAC,QAFR;AAGE,gBAAA,EAAE,EAAC,QAHL;AAIE,gBAAA,IAAI,EAAC,eAJP;AAKE,gBAAA,KAAK,EAAC,QALR;AAME,gBAAA,QAAQ,EAAGwD,CAAD,IAAOvD,gBAAgB,CAACuD,CAAC,CAACC,MAAF,CAASC,KAAV;AANnC;AAAA;AAAA;AAAA;AAAA,sBADF,eASE,QAAC,IAAD,CAAM,KAAN;AACE,gBAAA,IAAI,EAAC,OADP;AAEE,gBAAA,KAAK,EAAC,oBAFR;AAGE,gBAAA,EAAE,EAAC,QAHL;AAIE,gBAAA,IAAI,EAAC,eAJP;AAKE,gBAAA,KAAK,EAAC,QALR;AAME,gBAAA,QAAQ,EAAGF,CAAD,IAAOvD,gBAAgB,CAACuD,CAAC,CAACC,MAAF,CAASC,KAAV;AANnC;AAAA;AAAA;AAAA;AAAA,sBATF,eAiBE,QAAC,MAAD;AAAQ,gBAAA,IAAI,EAAC,QAAb;AAAsB,gBAAA,OAAO,EAAC,SAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAjBF;AAAA;AAAA;AAAA;AAAA;AAAA,oBADD,GAsBGtD,QAAQ,gBACV,QAAC,YAAD;AACE,cAAA,MAAM,EAAES,KAAK,CAACgC,UADhB;AAEE,cAAA,SAAS,EAAER;AAFb;AAAA;AAAA;AAAA;AAAA,oBADU,gBAMV,QAAC,QAAD;AAAU,cAAA,OAAO,EAAED,OAAnB;AAA4B,cAAA,MAAM,EAAEtC,aAApC;AAAA,qCACE,QAAC,YAAD;AAAc,gBAAA,YAAY,EAAEI,YAA5B;AAA0C,gBAAA,EAAE,EAAEI;AAA9C;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AA7BJ;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAlBF;AAAA;AAAA;AAAA;AAAA;AAAA,cAtEF;AAAA;AAAA;AAAA;AAAA;AAAA;AAFJ,mBADF;AAqID,CAzMD;;GAAMP,gB;UAKWV,S,EACEC,W,EACAF,W,EAECG,W,EAGGA,W;;;KAZjBQ,gB;AA2MN,eAAeA,gBAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { PayPalButton } from \"react-paypal-button-v2\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport { Elements } from \"@stripe/react-stripe-js\";\r\nimport CheckoutForm from \"../components/CheckoutForm\";\r\nimport {\r\n  Button,\r\n  Form,\r\n  Row,\r\n  Col,\r\n  ListGroup,\r\n  Image,\r\n  Card,\r\n} from \"react-bootstrap\";\r\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport Container from \"../components/Container\";\r\nimport Message from \"../components/Message\";\r\nimport CheckoutSteps from \"../components/CheckoutSteps\";\r\nimport { getOrder, payOrder } from \"../actions/orderActions\";\r\nimport { logout } from \"../actions/userActions\";\r\n\r\nconst stripePromise = loadStripe(\r\n  \"pk_test_51KfRvoCiXm4UN3ie2rCe8bQxPrNDY3Fck0a33xKG8NlkqieYNBmUcd26Wu1DdKA9lrGZrDLBIPx7UhxBvVErUaEs00F5dPdgJD\"\r\n);\r\nconst PlaceOrderScreen = () => {\r\n  const [paymentMethod, setPaymentMethod] = useState(\"\");\r\n  const [clientSecret, setClientSecret] = useState(\"\");\r\n  const [sdkReady, setSdkReady] = useState(false);\r\n\r\n  const { id } = useParams();\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n\r\n  const orderDetails = useSelector((state) => state.orderDetails);\r\n  const { order, shippingAddress, error } = orderDetails;\r\n\r\n  useEffect(() => {\r\n    if (!userInfo) {\r\n      dispatch(logout());\r\n      navigate(\"/login\");\r\n    }\r\n    dispatch(getOrder(id));\r\n\r\n    async function stripeHandler() {\r\n      const name = order.customer.name;\r\n      const email = order.customer.email;\r\n      const { data } = await axios.post(\"/create-payment-intent\", {\r\n        id,\r\n        name,\r\n        email,\r\n      });\r\n      setClientSecret(data.clientSecret);\r\n    }\r\n\r\n    const addPayPalScript = async () => {\r\n      const { data: clientId } = await axios.get(\"/api/config/paypal\");\r\n      const script = document.createElement(\"script\");\r\n      script.type = \"text/javascript\";\r\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\r\n      script.async = true;\r\n      script.onload = () => {\r\n        setSdkReady(true);\r\n      };\r\n      document.body.appendChild(script);\r\n      setSdkReady(true);\r\n    };\r\n    if (paymentMethod === \"PayPal\") {\r\n      addPayPalScript();\r\n    } else {\r\n      setSdkReady(true);\r\n    }\r\n\r\n    if (paymentMethod === \"Stripe\") {\r\n      stripeHandler();\r\n    }\r\n  }, [dispatch, id, userInfo, paymentMethod, sdkReady]);\r\n\r\n  const appearance = {\r\n    theme: \"stripe\",\r\n  };\r\n  const options = {\r\n    clientSecret,\r\n    appearance,\r\n  };\r\n\r\n  const successPaymentHandler = () => {\r\n    dispatch(payOrder(id));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {order && (\r\n        <Container>\r\n          <CheckoutSteps step1 step2 step3 id={id} />\r\n          <Row>\r\n            <Col md={8}>\r\n              <h2>Order Items</h2>\r\n              <Card className=\"p-3\">\r\n                <ListGroup variant=\"flush\">\r\n                  {order.orderItems.map((item) => (\r\n                    <ListGroup.Item key={item._id}>\r\n                      <Row className=\"d-flex justify-content-between align-items-center\">\r\n                        <Col md={2}>\r\n                          <Image\r\n                            src={item.image}\r\n                            alt={item.name}\r\n                            fluid\r\n                            rounded\r\n                            sm={1}\r\n                          />\r\n                        </Col>\r\n                        <Col md={2}>\r\n                          <Link to={`/product/${item.productId}`}>\r\n                            {item.name}\r\n                          </Link>\r\n                        </Col>\r\n                        <Col md={2}>${item.price}</Col>\r\n                        <Col md={1}>{item.qty}</Col>\r\n\r\n                        <Col className=\"d-flex justify-content-center\" md={2}>\r\n                          {item.totalPrice\r\n                            ? `$${item.totalPrice.toFixed(2)}`\r\n                            : `$${item.price.toFixed(2)}`}\r\n                        </Col>\r\n                      </Row>\r\n                    </ListGroup.Item>\r\n                  ))}\r\n                </ListGroup>\r\n              </Card>\r\n            </Col>\r\n            <Col md={4}>\r\n              <h2>Order Summary</h2>\r\n              <Card className=\"p-3\">\r\n                <ListGroup variant=\"flush\">\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>Items</Col>\r\n                      <Col>${order.itemsPrice.toFixed(2)}</Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>Shipping</Col>\r\n                      <Col>${order.shippingPrice.toFixed(2)}</Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>Tax</Col>\r\n                      <Col>${order.taxPrice.toFixed(2)}</Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>Total</Col>\r\n                      <Col>${order.totalPrice.toFixed(2)}</Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                </ListGroup>\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n          <Row className=\"my-5\">\r\n            <Col md={8}>\r\n              <h2>Shipping Information</h2>\r\n              <Card className=\"p-3\">\r\n                <ListGroup variant=\"flush\">\r\n                  <ListGroup.Item>\r\n                    <strong>Name:</strong> {order.user.name}\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <strong>email:</strong> {order.user.email}\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <strong>Shipping Address:</strong>\r\n                    {` ${order.shippingAddress.address}, ${order.shippingAddress.city} ${order.shippingAddress.state} ${order.shippingAddress.postalCode}, ${order.shippingAddress.country}`}\r\n                  </ListGroup.Item>\r\n                </ListGroup>\r\n              </Card>\r\n            </Col>\r\n            <Col md={4}>\r\n              <h2>Payment Method</h2>\r\n              <Card className=\"p-3\">\r\n                {!paymentMethod ? (\r\n                  <ListGroup variant=\"flush\">\r\n                    <Form.Check\r\n                      type=\"radio\"\r\n                      label=\"Paypal\"\r\n                      id=\"PayPal\"\r\n                      name=\"paymentMethod\"\r\n                      value=\"PayPal\"\r\n                      onChange={(e) => setPaymentMethod(e.target.value)}\r\n                    ></Form.Check>\r\n                    <Form.Check\r\n                      type=\"radio\"\r\n                      label=\"Stripe/Credit Card\"\r\n                      id=\"Stripe\"\r\n                      name=\"paymentMethod\"\r\n                      value=\"Stripe\"\r\n                      onChange={(e) => setPaymentMethod(e.target.value)}\r\n                    ></Form.Check>\r\n                    <Button type=\"submit\" variant=\"primary\">\r\n                      Continue\r\n                    </Button>\r\n                  </ListGroup>\r\n                ) : sdkReady ? (\r\n                  <PayPalButton\r\n                    amount={order.totalPrice}\r\n                    onSuccess={successPaymentHandler}\r\n                  />\r\n                ) : (\r\n                  <Elements options={options} stripe={stripePromise}>\r\n                    <CheckoutForm clientSecret={clientSecret} id={id} />\r\n                  </Elements>\r\n                )}\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n        </Container>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PlaceOrderScreen;\r\n"]},"metadata":{},"sourceType":"module"}